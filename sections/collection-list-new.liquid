{{ 'collection-list.css' | asset_url | stylesheet_tag }}
{{ 'collection-header.css' | asset_url | stylesheet_tag }}

<script>
  window.L2FilterConfig = {
    currency: '{{ shop_currency | escape }}',
    moneyFormat: '{{ shop_money_format | escape }}',
    moneyWithCurrencyFormat: '{{ shop_money_with_currency_format | escape }}',
  };
</script>

{{ 'collection-filters.js' | asset_url | script_tag }}

{%- liquid
  assign is_valid_context = false
  if collection
    assign is_valid_context = true
  endif

  assign burglary_grade = collection.metafields.custom.burglary_grade.value
  if burglary_grade == blank
    assign burglary_grade = collection.metafields.custom.burglary_grade_mt.value
  endif

  assign fire_resistance = collection.metafields.custom.fire_resistance.value
  if fire_resistance == blank
    assign fire_resistance = collection.metafields.custom.fire_resistant_mt.value
  endif

  assign child_handles_csv = ''
  assign seen_child = ''

  assign min_price = 999999999
  assign max_price = 0
  assign collection_prices = ''

  assign min_depth = 999999
  assign max_depth = 0
  assign min_width = 999999
  assign max_width = 0
  assign min_height = 999999
  assign max_height = 0
  assign min_weight = 999999
  assign max_weight = 0
  assign min_variant_weight = 999999
  assign max_variant_weight = 0

  assign has_depth_data = false
  assign has_width_data = false
  assign has_height_data = false
  assign has_weight_data = false
  assign has_variant_weight_data = false

  assign fallback_burglary_csv = ''
  assign fallback_fire_csv = ''

  if is_valid_context
    paginate collection.products by 1000
      for p in collection.products
        for c in p.collections
          assign excluded_handles = 'pengeskabe,vaerdiskabe,dokumentskabe,dataskabe,computerskabe,indmuringsboks,deponeringsskabe,noegleskabe,vaabenskabe,kemiskabe,batteriopbevaring,medicinskab,alle-vaerdiskabe,alle_vaerdiskabe,brandskabe'
          if c.handle != collection.handle and c.handle != 'frontpage'
            unless seen_child contains c.handle or excluded_handles contains c.handle
              assign seen_child = seen_child | append: ',' | append: c.handle
              assign child_handles_csv = child_handles_csv | append: ',' | append: c.handle
            endunless
          endif
        endfor

        assign d = p.metafields.custom.new_depth.value | remove: ' mm' | remove: 'mm' | plus: 0
        assign w = p.metafields.custom.new_width.value | remove: ' mm' | remove: 'mm' | plus: 0
        assign h = p.metafields.custom.new_height.value | remove: ' mm' | remove: 'mm' | plus: 0
        assign kg = p.metafields.custom.weight.value | remove: ' kg' | remove: 'kg' | plus: 0

        assign variant_weight = ''
        if p.variants.size > 0
          assign first_variant = p.variants.first
          assign variant_weight = first_variant.weight
        endif

        if d > 0
          assign has_depth_data = true
          if d < min_depth
            assign min_depth = d
          endif
          if d > max_depth
            assign max_depth = d
          endif
        endif

        if w > 0
          assign has_width_data = true
          if w < min_width
            assign min_width = w
          endif
          if w > max_width
            assign max_width = w
          endif
        endif

        if h > 0
          assign has_height_data = true
          if h < min_height
            assign min_height = h
          endif
          if h > max_height
            assign max_height = h
          endif
        endif

        if kg > 0
          assign has_weight_data = true
          if kg < min_weight
            assign min_weight = kg
          endif
          if kg > max_weight
            assign max_weight = kg
          endif
        endif

        if variant_weight != blank and variant_weight != ''
          assign variant_weight_num = variant_weight | plus: 0
          if variant_weight_num > 0
            assign variant_weight_kg = variant_weight_num | divided_by: 1000.0
            assign has_variant_weight_data = true
            if variant_weight_kg < min_variant_weight
              assign min_variant_weight = variant_weight_kg
            endif
            if variant_weight_kg > max_variant_weight
              assign max_variant_weight = variant_weight_kg
            endif
          endif
        endif

        assign fb_b = p.metafields.custom.burglary_classification.value
        if fb_b != blank
          unless fallback_burglary_csv contains fb_b
            assign fallback_burglary_csv = fallback_burglary_csv | append: ',' | append: fb_b
          endunless
        endif

        assign fb_f = p.metafields.custom.fire_duration.value
        if fb_f != blank
          unless fallback_fire_csv contains fb_f
            assign fallback_fire_csv = fallback_fire_csv | append: ',' | append: fb_f
          endunless
        endif
      endfor
    endpaginate
  endif

  assign child_handles = child_handles_csv | remove_first: ',' | split: ',' | uniq

  assign all_burglary_csv = ''
  assign all_fire_csv = ''
  assign all_categories_csv = ''

  if child_handles and child_handles.size > 0
    for h in child_handles
      assign col = collections[h]
      if col
        assign category_name = col.title
        unless all_categories_csv contains category_name
          assign all_categories_csv = all_categories_csv | append: ',' | append: category_name
        endunless

        assign c_b = ''
        assign c_f = ''

        if col.products.size > 0
          for p in col.products
            assign p_b = p.metafields.custom.burglary_classification.value
            assign p_f = p.metafields.custom.fire_duration.value

            if p_b != blank
              unless all_burglary_csv contains p_b
                assign all_burglary_csv = all_burglary_csv | append: ',' | append: p_b
              endunless
            endif

            if p_f != blank
              unless all_fire_csv contains p_f
                assign all_fire_csv = all_fire_csv | append: ',' | append: p_f
              endunless
            endif
          endfor
        endif

        assign collection_min_price = 0
        if col.products.size > 0
          for p in col.products
            if collection_min_price == 0 or p.price_min < collection_min_price
              assign collection_min_price = p.price_min
            endif
          endfor

          if collection_min_price > 0
            if collection_min_price < min_price
              assign min_price = collection_min_price
            endif
            if collection_min_price > max_price
              assign max_price = collection_min_price
            endif
          endif
        endif
      endif
    endfor
  endif

  if is_valid_context
    paginate collection.products by 1000
      for product in collection.products
        assign prod_burglary = product.metafields.custom.burglary_classification.value
        assign prod_fire = product.metafields.custom.fire_duration.value

        if prod_burglary != blank
          assign all_burglary_csv = all_burglary_csv | append: ',' | append: prod_burglary
        endif

        if prod_fire != blank
          assign all_fire_csv = all_fire_csv | append: ',' | append: prod_fire
        endif
      endfor
    endpaginate
  endif

  if all_burglary_csv == ''
    assign all_burglary_csv = fallback_burglary_csv
  endif
  if all_fire_csv == ''
    assign all_fire_csv = fallback_fire_csv
  endif

  assign all_burglary_grades = all_burglary_csv | remove_first: ',' | split: ',' | uniq
  assign all_fire_resistance = all_fire_csv | remove_first: ',' | split: ',' | uniq
  assign all_categories = all_categories_csv | remove_first: ',' | split: ',' | uniq

  if min_price == 999999999 or max_price == 0
    assign min_price = 0
    assign max_price = 0
  endif

  assign shop_currency = shop.currency
  assign shop_money_format = shop.money_format
  assign shop_money_with_currency_format = shop.money_with_currency_format
-%}

<div class="page-width">
  {% if section.settings.show_more_link != blank %}
    <div class="show-more-wrapper">
      <a href="{{ section.settings.show_more_link }}" class="show-more-btn">
        {{ section.settings.show_more_text | default: 'Click here for more...' }}
      </a>
    </div>
  {% endif %}

  <div
    class="collections-container"
    data-collections-per-page="{{ section.settings.collections_per_page | default: 12 }}"
    data-show-pagination="{{ section.settings.show_pagination | default: true }}"
  >
    <div class="filters-sidebar">
      <div class="filters-container">
        <h3 class="filters-title">{{ section.settings.filters_title | default: 'Filters' }}</h3>
        {% assign is_first_group = true %}

        {% if all_burglary_grades.size > 0 %}
          <div class="filter-group">
            <h4 class="filter-group-title" data-accordion="burglary">
              {{ section.settings.burglary_grade_label | default: 'Burglary Grade' }}
              <span class="accordion-icon">{% if is_first_group %}−{% else %}+{% endif %}</span>
            </h4>
            <div class="filter-options" data-accordion-content="burglary" {% unless is_first_group %}style="display: none;"{% endunless %}>
              {% assign is_first_group = false %}
              {% assign sorted_burglary = all_burglary_grades | sort %}
              {% for grade in sorted_burglary %}
                {% if grade == 'Ingen klassificering' %}
                  <label class="filter-checkbox">
                    <input type="checkbox" name="burglary_grade" value="{{ grade }}" data-filter-type="burglary_grade">
                    <span class="checkmark"></span>
                    {{ grade }}
                  </label>
                {% endif %}
              {% endfor %}
              {% for grade in sorted_burglary %}
                {% unless grade == 'Ingen klassificering' %}
                  <label class="filter-checkbox">
                    <input type="checkbox" name="burglary_grade" value="{{ grade }}" data-filter-type="burglary_grade">
                    <span class="checkmark"></span>
                    {{ grade }}
                  </label>
                {% endunless %}
              {% endfor %}
            </div>
          </div>
        {% endif %}

        {% if all_fire_resistance.size > 0 %}
          <div class="filter-group">
            <h4 class="filter-group-title" data-accordion="fire">
              {{ section.settings.fire_resistance_label | default: 'Fire Resistance' }}
              <span class="accordion-icon">{% if is_first_group %}−{% else %}+{% endif %}</span>
            </h4>
            <div class="filter-options" data-accordion-content="fire" {% unless is_first_group %}style="display: none;"{% endunless %}>
              {% assign is_first_group = false %}
              {% assign sorted_fire = all_fire_resistance | sort %}
              <!-- Show fire resistance in specific order based on content -->
              {% assign fire_order = '30minutter,60minutter,90minutter,120minutter' | split: ',' %}
              {% for target_duration in fire_order %}
                {% for resistance in sorted_fire %}
                  {% if resistance == target_duration %}
                    <label class="filter-checkbox">
                      <input
                        type="checkbox"
                        name="fire_resistance"
                        value="{{ resistance }}"
                        data-filter-type="fire_resistance"
                      >
                      <span class="checkmark"></span>
                      {{ resistance }}
                    </label>
                  {% endif %}
                {% endfor %}
              {% endfor %}
              <!-- Show any other fire resistance values not in the main order -->
              {% for resistance in sorted_fire %}
                {% unless fire_order contains resistance %}
                  <label class="filter-checkbox">
                    <input
                      type="checkbox"
                      name="fire_resistance"
                      value="{{ resistance }}"
                      data-filter-type="fire_resistance"
                    >
                    <span class="checkmark"></span>
                    {{ resistance }}
                  </label>
                {% endunless %}
              {% endfor %}
            </div>
          </div>
        {% endif %}

        {% if max_price > 0 and min_price < max_price %}
          <div class="filter-group price-filter-group">
            <h4 class="filter-group-title" data-accordion="price">
              {{ section.settings.price_range_label | default: 'Price Range' }}
              <span class="accordion-icon">{% if is_first_group %}−{% else %}+{% endif %}</span>
            </h4>
            <div class="filter-options" data-accordion-content="price" {% unless is_first_group %}style="display: none;"{% endunless %}>
              {% assign is_first_group = false %}
              <div class="price-range-container">
                <div class="price-range-slider-container">
                  <div class="price-range-slider">
                    <div class="price-range-track"></div>
                    <input
                      type="range"
                      id="price-min"
                      class="price-slider price-slider-min"
                      min="{{ min_price | divided_by: 100 }}"
                      max="{{ max_price | divided_by: 100 }}"
                      value="{{ min_price | divided_by: 100 }}"
                      step="1"
                      data-filter-type="price_range"
                      aria-label="Minimum price"
                    >
                    <input
                      type="range"
                      id="price-max"
                      class="price-slider price-slider-max"
                      min="{{ min_price | divided_by: 100 }}"
                      max="{{ max_price | divided_by: 100 }}"
                      value="{{ max_price | divided_by: 100 }}"
                      step="1"
                      data-filter-type="price_range"
                      aria-label="Maximum price"
                    >
                  </div>

                  <div class="price-range-labels">
                    <span class="price-min-label">{{ min_price | money }}</span>
                    <span class="price-max-label">{{ max_price | money }}</span>
                  </div>

                  <div class="price-range-inputs">
                    <input
                      type="text"
                      id="price-min-input"
                      class="price-input price-min-input"
                      min="{{ min_price | divided_by: 100 }}"
                      max="{{ max_price | divided_by: 100 }}"
                      value="{{ min_price | divided_by: 100 | money_without_currency }}"
                      placeholder="Min"
                    >
                    <span class="range-separator">-</span>
                    <input
                      type="text"
                      id="price-max-input"
                      class="price-input price-max-input"
                      min="{{ min_price | divided_by: 100 }}"
                      max="{{ max_price | divided_by: 100 }}"
                      value="{{ max_price | divided_by: 100 | money_without_currency }}"
                      placeholder="Max"
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        {% endif %}

        {% assign dimensions = 'depth,width,height' | split: ',' %}
        {% for dimension in dimensions %}
          {% assign has_data = false %}
          {% assign min_val = 0 %}
          {% assign max_val = 0 %}
          {% assign unit = 'mm' %}
          {% assign title = '' %}

          {% case dimension %}
            {% when 'depth' %}
              {% assign has_data = has_depth_data %}
              {% assign min_val = min_depth %}
              {% assign max_val = max_depth %}
              {% assign title = section.settings.depth_label | default: 'Exterior Depth' %}
            {% when 'width' %}
              {% assign has_data = has_width_data %}
              {% assign min_val = min_width %}
              {% assign max_val = max_width %}
              {% assign title = section.settings.width_label | default: 'Exterior Width' %}
            {% when 'height' %}
              {% assign has_data = has_height_data %}
              {% assign min_val = min_height %}
              {% assign max_val = max_height %}
              {% assign title = section.settings.height_label | default: 'External Height' %}
            {% when 'weight' %}
              {% assign has_data = has_weight_data %}
              {% assign min_val = min_weight %}
              {% assign max_val = max_weight %}
              {% assign title = section.settings.weight_label | default: 'Weight' %}
              {% assign unit = 'kg' %}
          {% endcase %}

          {% if has_data and max_val > min_val %}
            <div class="filter-group dimension-filter-group">
              <h4 class="filter-group-title" data-accordion="{{ dimension }}">
                {{ title }} ({{ unit }})
                <span class="accordion-icon">{% if is_first_group %}−{% else %}+{% endif %}</span>
              </h4>
              <div class="filter-options" data-accordion-content="{{ dimension }}" {% unless is_first_group %}style="display: none;"{% endunless %}>
                {% assign is_first_group = false %}
                <div class="dimension-range-container">
                  <div class="dimension-range-slider-container">
                    <div class="dimension-range-slider">
                      <div class="{{ dimension }}-range-track"></div>
                      <input
                        type="range"
                        id="{{ dimension }}-min"
                        class="dimension-slider {{ dimension }}-slider-min"
                        min="{{ min_val }}"
                        max="{{ max_val }}"
                        value="{{ min_val }}"
                        step="1"
                        data-filter-type="{{ dimension }}_range"
                        aria-label="Minimum {{ dimension }}"
                      >
                      <input
                        type="range"
                        id="{{ dimension }}-max"
                        class="dimension-slider {{ dimension }}-slider-max"
                        min="{{ min_val }}"
                        max="{{ max_val }}"
                        value="{{ max_val }}"
                        step="1"
                        data-filter-type="{{ dimension }}_range"
                        aria-label="Maximum {{ dimension }}"
                      >
                    </div>

                    <div class="dimension-range-labels">
                      <span class="{{ dimension }}-min-label">{{ min_val }}</span>
                      <span class="{{ dimension }}-max-label">{{ max_val }}</span>
                    </div>

                    <div class="dimension-range-inputs">
                      <input
                        type="number"
                        id="{{ dimension }}-min-input"
                        class="dimension-input {{ dimension }}-min-input"
                        min="{{ min_val }}"
                        max="{{ max_val }}"
                        value="{{ min_val }}"
                        placeholder="Min"
                      >
                      <span class="range-separator">-</span>
                      <input
                        type="number"
                        id="{{ dimension }}-max-input"
                        class="dimension-input {{ dimension }}-max-input"
                        min="{{ min_val }}"
                        max="{{ max_val }}"
                        value="{{ max_val }}"
                        placeholder="Max"
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>
          {% endif %}
        {% endfor %}

        {% if has_variant_weight_data and max_variant_weight > min_variant_weight %}
          <div class="filter-group dimension-filter-group">
            <h4 class="filter-group-title" data-accordion="variant_weight">
              Variant Vægt (kg)
              <span class="accordion-icon">{% if is_first_group %}−{% else %}+{% endif %}</span>
            </h4>
            <div class="filter-options" data-accordion-content="variant_weight" {% unless is_first_group %}style="display: none;"{% endunless %}>
              {% assign is_first_group = false %}
              <div class="dimension-range-container">
                <div class="dimension-range-slider-container">
                  <div class="dimension-range-slider">
                    <div class="variant_weight-range-track"></div>
                    <input
                      type="range"
                      id="variant_weight-min"
                      class="dimension-slider variant_weight-slider-min"
                      min="{{ min_variant_weight }}"
                      max="{{ max_variant_weight }}"
                      value="{{ min_variant_weight }}"
                      step="0.01"
                      data-filter-type="variant_weight_range"
                      aria-label="Minimum variant weight"
                    >
                    <input
                      type="range"
                      id="variant_weight-max"
                      class="dimension-slider variant_weight-slider-max"
                      min="{{ min_variant_weight }}"
                      max="{{ max_variant_weight }}"
                      value="{{ max_variant_weight }}"
                      step="0.01"
                      data-filter-type="variant_weight_range"
                      aria-label="Maximum variant weight"
                    >
                  </div>

                  <div class="dimension-range-labels">
                    <span class="variant_weight-min-label">{{ min_variant_weight }}</span>
                    <span class="variant_weight-max-label">{{ max_variant_weight }}</span>
                  </div>

                  <div class="dimension-range-inputs">
                    <input
                      type="number"
                      id="variant_weight-min-input"
                      class="dimension-input variant_weight-min-input"
                      min="{{ min_variant_weight }}"
                      max="{{ max_variant_weight }}"
                      value="{{ min_variant_weight }}"
                      placeholder="Min"
                    >
                    <span class="range-separator">-</span>
                    <input
                      type="number"
                      id="variant_weight-max-input"
                      class="dimension-input variant_weight-max-input"
                      min="{{ min_variant_weight }}"
                      max="{{ max_variant_weight }}"
                      value="{{ max_variant_weight }}"
                      placeholder="Max"
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        {% endif %}

        {% if all_categories.size > 0 %}
          <div class="filter-group">
            <h4 class="filter-group-title" data-accordion="category">
              {{ section.settings.category_label | default: 'Category' }}
              <span class="accordion-icon">{% if is_first_group %}−{% else %}+{% endif %}</span>
            </h4>
            <div class="filter-options" data-accordion-content="category" {% unless is_first_group %}style="display: none;"{% endunless %}>
              {% assign is_first_group = false %}
              <div class="category-options-container">
                {% assign sorted_categories = all_categories | sort %}
                {% for category in sorted_categories %}
                  <label
                    class="filter-checkbox category-checkbox {% if forloop.index > 8 %}category-hidden{% endif %}"
                    {% if forloop.index > 8 %}
                      style="display: none;"
                    {% endif %}
                  >
                    <input type="checkbox" name="category" value="{{ category }}" data-filter-type="category">
                    <span class="checkmark"></span>
                    {{ category }}
                  </label>
                {% endfor %}
                {% if all_categories.size > 8 %}
                  <button
                    type="button"
                    class="show-more-categories"
                    data-show-less-text="{{ section.settings.show_less_categories_text | default: 'Show Less Categories' }}"
                  >
                    {{ section.settings.show_more_categories_text | default: 'Show More Categories' }}
                  </button>
                {% endif %}
              </div>
            </div>
          </div>
        {% endif %}

        <div class="filter-actions">
          <button type="button" id="clear-filters" class="clear-filters-btn">
            {{ section.settings.clear_filters_text | default: 'Clear All Filters' }}
          </button>
        </div>
      </div>
    </div>

    <div class="mobile-filter-toggle">
      <button type="button" id="mobile-filter-btn" class="mobile-filter-button">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M3 7H21L19 9V16C19 17.1 18.1 18 17 18H7C5.9 18 5 17.1 5 16V9L3 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M8 7V5C8 3.9 8.9 3 10 3H14C15.1 3 16 3.9 16 5V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        {{ section.settings.mobile_filter_text | default: 'Filters' }}
        <span class="filter-count" id="active-filter-count" style="display: none;">0</span>
      </button>
    </div>

    <div class="mobile-filter-overlay" id="mobile-filter-overlay">
      <div class="mobile-filter-drawer" id="mobile-filter-drawer">
        <div class="mobile-filter-header">
          <h3>{{ section.settings.mobile_filter_title | default: 'Filters' }}</h3>
          <button type="button" id="mobile-filter-close" class="mobile-filter-close">×</button>
        </div>
        <div class="mobile-filter-content"></div>
        <div class="mobile-filter-footer">
          <button type="button" id="mobile-clear-filters" class="mobile-clear-btn">
            {{ section.settings.mobile_clear_text | default: 'Clear All' }}
          </button>
          <button type="button" id="mobile-apply-filters" class="mobile-apply-btn">
            {{ section.settings.mobile_apply_text | default: 'Apply Filters' }}
          </button>
        </div>
      </div>
    </div>

    <div class="collections-content">
      {% if collection.title != blank or collection.description != blank %}
        <div class="collection-header">
          {% if collection.title != blank %}
            <h1 class="collection-title">{{ collection.title }}</h1>
          {% endif %}
          {% if collection.description != blank %}
            <div class="collection-description">{{ collection.description | strip_html }}</div>
          {% endif %}
          {% if burglary_grade != blank or fire_resistance != blank %}
            <div class="collection-header__features">
              {% comment %} Auto-generated Burglary Resistance feature {% endcomment %}
              {% if burglary_grade != blank %}
                <div class="feature-item feature-item--auto feature-item--burglary">
                  <div class="feature-item__icon">
                    {% case burglary_grade %}
                      {% when 'S1' %}
                        {% if settings.icon_burglary_s1 != blank %}
                          <img src="{{ settings.icon_burglary_s1 | image_url: width: 48 }}" alt="S1 Grade" width="24" height="24">
                        {% endif %}
                      {% when 'S2' %}
                        {% if settings.icon_burglary_s2 != blank %}
                          <img src="{{ settings.icon_burglary_s2 | image_url: width: 48 }}" alt="S2 Grade" width="24" height="24">
                        {% endif %}
                      {% when 'Grade 0' %}
                        {% if settings.icon_burglary_grade_0 != blank %}
                          <img src="{{ settings.icon_burglary_grade_0 | image_url: width: 48 }}" alt="Grade 0" width="24" height="24">
                        {% endif %}
                      {% when 'Grade I' %}
                        {% if settings.icon_burglary_grade_1 != blank %}
                          <img src="{{ settings.icon_burglary_grade_1 | image_url: width: 48 }}" alt="Grade I" width="24" height="24">
                        {% endif %}
                      {% when 'Grade II' or 'GRADE II' %}
                        {% if settings.icon_burglary_grade_2 != blank %}
                          <img src="{{ settings.icon_burglary_grade_2 | image_url: width: 48 }}" alt="Grade II" width="24" height="24">
                        {% endif %}
                      {% when 'Grade III' or 'GRADE III' %}
                        {% if settings.icon_burglary_grade_3 != blank %}
                          <img src="{{ settings.icon_burglary_grade_3 | image_url: width: 48 }}" alt="Grade III" width="24" height="24">
                        {% endif %}
                      {% when 'Grade IV' or 'GRADE IV' %}
                        {% if settings.icon_burglary_grade_4 != blank %}
                          <img src="{{ settings.icon_burglary_grade_4 | image_url: width: 48 }}" alt="Grade IV" width="24" height="24">
                        {% endif %}
                      {% when 'Grade V' or 'GRADE V' %}
                        {% if settings.icon_burglary_grade_5 != blank %}
                          <img src="{{ settings.icon_burglary_grade_5 | image_url: width: 48 }}" alt="Grade V" width="24" height="24">
                        {% endif %}
                    {% endcase %}
                  </div>
                  <div class="feature-item__content">
                    <h3 class="feature-item__title">Certified Burglary Resistance</h3>
                    <div class="feature-item__text">
                      {% case burglary_grade %}
                        {% when 'S1' %}
                          {{ settings.icon_burglary_s1_description | default: 'Tested according to European standard EN-1143-1. S1 certified.' }}
                        {% when 'S2' %}
                          {{ settings.icon_burglary_s2_description | default: 'Tested according to European standard EN-1143-1. S2 certified.' }}
                        {% when 'Grade 0' %}
                          {{ settings.icon_burglary_grade_0_description | default: 'Tested according to European standard EN-1143-1. Grade 0 certified.' }}
                        {% when 'Grade I' %}
                          {{ settings.icon_burglary_grade_1_description | default: 'Tested according to European standard EN-1143-1. Grade I certified.' }}
                        {% when 'Grade II' or 'GRADE II' %}
                          {{ settings.icon_burglary_grade_2_description | default: 'Tested according to European standard EN-1143-1. Grade II certified.' }}
                        {% when 'Grade III' or 'GRADE III' %}
                          {{ settings.icon_burglary_grade_3_description | default: 'Tested according to European standard EN-1143-1. Grade III certified.' }}
                        {% when 'Grade IV' or 'GRADE IV' %}
                          {{ settings.icon_burglary_grade_4_description | default: 'Tested according to European standard EN-1143-1. Grade IV certified.' }}
                        {% when 'Grade V' or 'GRADE V' %}
                          {{ settings.icon_burglary_grade_5_description | default: 'Tested according to European standard EN-1143-1. Grade V certified.' }}
                        {% else %}
                          <p>{{ section.settings.burglary_description | default: 'Tested according to European standard EN-1143-1.' }} <strong>{{ burglary_grade }}</strong> certified.</p>
                      {% endcase %}
                    </div>
                  </div>
                </div>
              {% endif %}

              {% comment %} Auto-generated Fire Resistance feature {% endcomment %}
              {% if fire_resistance != blank %}
                <div class="feature-item feature-item--auto feature-item--fire">
                  <div class="feature-item__icon">
                    {% case fire_resistance %}
                      {% when '30 Minutes' or '30 minutter' %}
                        {% if settings.icon_fire_30_minutes != blank %}
                          <img src="{{ settings.icon_fire_30_minutes | image_url: width: 48 }}" alt="30 Minutes Fire Protection" width="24" height="24">
                        {% endif %}
                      {% when '60 Minutes' or '60 minutter' %}
                        {% if settings.icon_fire_60_minutes != blank %}
                          <img src="{{ settings.icon_fire_60_minutes | image_url: width: 48 }}" alt="60 Minutes Fire Protection" width="24" height="24">
                        {% endif %}
                      {% when '90 Minutes' or '90 minutter' %}
                        {% if settings.icon_fire_90_minutes != blank %}
                          <img src="{{ settings.icon_fire_90_minutes | image_url: width: 48 }}" alt="90 Minutes Fire Protection" width="24" height="24">
                        {% endif %}
                      {% when '120 Minutes' or '120 minutter' %}
                        {% if settings.icon_fire_120_minutes != blank %}
                          <img src="{{ settings.icon_fire_120_minutes | image_url: width: 48 }}" alt="120 Minutes Fire Protection" width="24" height="24">
                        {% endif %}
                      {% when 'Fire Insulated' %}
                        {% if settings.icon_fire_insulated != blank %}
                          <img src="{{ settings.icon_fire_insulated | image_url: width: 48 }}" alt="Fire Insulated" width="24" height="24">
                        {% endif %}
                    {% endcase %}
                  </div>
                  <div class="feature-item__content">
                    <h3 class="feature-item__title">Certified Fire Protection</h3>
                    <div class="feature-item__text">
                      {% case fire_resistance %}
                        {% when '30 Minutes' or '30 minutter' %}
                          {{ settings.icon_fire_30_minutes_description | default: 'Tested according to European Standards. 30 Minutes fire protection certified.' }}
                        {% when '60 Minutes' or '60 minutter' %}
                          {{ settings.icon_fire_60_minutes_description | default: 'Tested according to European Standards. 60 Minutes fire protection certified.' }}
                        {% when '90 Minutes' or '90 minutter' %}
                          {{ settings.icon_fire_90_minutes_description | default: 'Tested according to European Standards. 90 Minutes fire protection certified.' }}
                        {% when '120 Minutes' or '120 minutter' %}
                          {{ settings.icon_fire_120_minutes_description | default: 'Tested according to European Standards. 120 Minutes fire protection certified.' }}
                        {% when 'Fire Insulated' %}
                          {{ settings.icon_fire_insulated_description | default: 'Tested according to European Standards. Fire Insulated protection certified.' }}
                        {% else %}
                          <p>{{ section.settings.fire_description | default: 'Tested according to European Standards.' }} <strong>{{ fire_resistance }}</strong> protection.</p>
                      {% endcase %}
                    </div>
                  </div>
                </div>
              {% endif %}
            </div>
          {% endif %}
        </div>
      {% endif %}

      <div class="results-info" style="display: none;">
        <div class="results-count">{{ section.settings.results_count_text | default: 'Showing all collections' }}</div>
      </div>

      <div class="collections-grid" id="collections-grid">
        {% if is_valid_context == false %}
          <div class="empty-state">This section works on collection templates only.</div>
        {% else %}
          {% if child_handles and child_handles.size > 0 %}
            {% for h in child_handles %}
              {% assign col = collections[h] %}
              {% if col %}
                {% liquid
                  assign collection_min_price = 0
                  assign cheapest_product = null
                  assign first_product = col.products.first
                  assign min_depth = 999999
                  assign max_depth = 0
                  assign min_width = 999999
                  assign max_width = 0
                  assign min_height = 999999
                  assign max_height = 0
                  assign has_depth_data = false
                  assign has_width_data = false
                  assign has_height_data = false
                  assign burglary_grade = ''
                  assign fire_resistance = ''

                  if first_product
                    for p in col.products
                      if collection_min_price == 0 or p.price_min < collection_min_price
                        assign collection_min_price = p.price_min
                        assign cheapest_product = p
                      endif

                      assign depth_val = p.metafields.custom.new_depth.value | remove: ' mm' | remove: 'mm' | plus: 0
                      assign width_val = p.metafields.custom.new_width.value | remove: ' mm' | remove: 'mm' | plus: 0
                      assign height_val = p.metafields.custom.new_height.value | remove: ' mm' | remove: 'mm' | plus: 0

                      if depth_val > 0
                        assign has_depth_data = true
                        if depth_val < min_depth
                          assign min_depth = depth_val
                        endif
                        if depth_val > max_depth
                          assign max_depth = depth_val
                        endif
                      endif

                      if width_val > 0
                        assign has_width_data = true
                        if width_val < min_width
                          assign min_width = width_val
                        endif
                        if width_val > max_width
                          assign max_width = width_val
                        endif
                      endif

                      if height_val > 0
                        assign has_height_data = true
                        if height_val < min_height
                          assign min_height = height_val
                        endif
                        if height_val > max_height
                          assign max_height = height_val
                        endif
                      endif

                      if burglary_grade == ''
                        assign burglary_grade = p.metafields.custom.burglary_classification.value
                      endif

                      if fire_resistance == ''
                        assign fire_resistance = p.metafields.custom.fire_duration.value
                      endif
                    endfor

                    assign fire_test_center = ''
                    assign fire_test_method = ''
                    assign burglary_test_center = ''
                    assign burglary_test_method = ''

                    for p in col.products
                      if fire_test_center == '' and p.metafields.custom.fire_test_center.value != blank
                        assign fire_test_center = p.metafields.custom.fire_test_center.value
                      endif
                      if fire_test_method == '' and p.metafields.custom.fire_test_method.value != blank
                        assign fire_test_method = p.metafields.custom.fire_test_method.value
                        assign fire_test_method_words = fire_test_method | split: ' '
                        if fire_test_method_words.size >= 2
                          assign fire_test_method = fire_test_method_words[0] | append: ' ' | append: fire_test_method_words[1]
                        endif
                      endif
                      if burglary_test_center == '' and p.metafields.custom.burglary_test_center.value != blank
                        assign burglary_test_center = p.metafields.custom.burglary_test_center.value
                      endif
                      if burglary_test_method == '' and p.metafields.custom.burglary_test_method.value != blank
                        assign burglary_test_method = p.metafields.custom.burglary_test_method.value
                        assign burglary_test_method_words = burglary_test_method | split: ' '
                        if burglary_test_method_words.size >= 2
                          assign burglary_test_method = burglary_test_method_words[0] | append: ' ' | append: burglary_test_method_words[1]
                        endif
                      endif
                    endfor

                    if min_depth == 999999
                      assign min_depth = 0
                    endif
                    if min_width == 999999
                      assign min_width = 0
                    endif
                    if min_height == 999999
                      assign min_height = 0
                    endif
                  endif

                  assign link_url = col.url
                  if cheapest_product
                    assign link_url = cheapest_product.url
                  endif
                %}

                <div
                  class="collection-card"
                  data-burglary-grade="{{ burglary_grade | default: '' | escape }}"
                  data-fire-resistance="{{ fire_resistance | default: '' | escape }}"
                  data-category="{{ col.title | escape }}"
                  data-price="{{ collection_min_price | divided_by: 100 }}"
                  data-depth-min="{{ min_depth | default: '0' }}"
                  data-depth-max="{{ max_depth | default: '0' }}"
                  data-width-min="{{ min_width | default: '0' }}"
                  data-width-max="{{ max_width | default: '0' }}"
                  data-height-min="{{ min_height | default: '0' }}"
                  data-height-max="{{ max_height | default: '0' }}"
                  data-link-url="{{ link_url }}"
                >
                  <div class="collection-card-top">
                    <div class="collection-image">
                      <a href="{{ link_url }}" aria-label="{{ col.title | escape }}">
                        {% if col.featured_image %}
                          <img
                            src="{{ col.featured_image | img_url: '290x178' }}"
                            alt="{{ col.title | escape }}"
                            loading="lazy"
                            width="290"
                            height="178"
                          >
                        {% else %}
                          <div
                            class="placeholder-image"
                            role="img"
                            aria-label="Placeholder image for {{ col.title | escape }}"
                          >
                            {{ 'collection-1' | placeholder_svg_tag }}
                          </div>
                        {% endif %}
                      </a>
                    </div>

                    <div class="collection-info">
                      <h3 class="collection-card-title">
                        {{ col.title | escape }}
                      </h3>

                      <div class="collection-content-wrapper">
                        <div class="collection-description">
                          {% if col.description != blank %}
                            <div class="collection-description-text">
                              {{ col.description | strip_html }}
                            </div>
                          {% endif %}
                        </div>

                        <div class="collection-specs-wrapper">
                          {% if has_depth_data or has_width_data or has_height_data %}
                            <div class="collection-dimensions">
                              {% if has_height_data %}
                                <div class="dimension-row">
                                  <span class="dimension-label">{{ section.settings.height_display_label | default: 'Height' }}</span>
                                  <span class="dimension-value">
                                  {% if min_height == max_height %}
                                    {{ min_height }} mm
                                  {% else %}
                                    {{ min_height }} - {{ max_height }} mm
                                  {% endif %}
                                  </span>
                                </div>
                              {% endif %}
                              {% if has_width_data %}
                                <div class="dimension-row">
                                  <span class="dimension-label">{{ section.settings.width_display_label | default: 'Width' }}</span>
                                  <span class="dimension-value">
                                  {% if min_width == max_width %}
                                    {{ min_width }} mm
                                  {% else %}
                                    {{ min_width }} - {{ max_width }} mm
                                  {% endif %}
                                  </span>
                                </div>
                              {% endif %}
                              {% if has_depth_data %}
                                <div class="dimension-row">
                                  <span class="dimension-label">{{ section.settings.depth_display_label | default: 'Depth' }}</span>
                                  <span class="dimension-value">
                                  {% if min_depth == max_depth %}
                                    {{ min_depth }} mm
                                  {% else %}
                                    {{ min_depth }} - {{ max_depth }} mm
                                  {% endif %}
                                  </span>
                                </div>
                              {% endif %}
                            </div>
                          {% endif %}
                        </div>

                        <div class="collection-placeholder">
                          <div class="collection-badges">
                            {% assign show_fire_badge = true %}
                            {% if fire_resistance == 'Ingen klassificering' or fire_resistance == 'Ikke Brandisoleret' %}
                              {% assign show_fire_badge = false %}
                            {% endif %}

                            {% if fire_resistance != blank and show_fire_badge and fire_resistance != 'Not Fireproof' %}
                              <div class="badge-with-info">
                              <div
                                class="badge fire-badge"
                                data-badge-type="fire"
                                data-badge-value="{{ fire_resistance | escape }}"
                                title="Fire Resistance: {{ fire_resistance | escape }}"
                              >
                                {% case fire_resistance %}
                                  {% when 'Fire Insulated', 'Brandisoleret', 'Fireproof' %}
                                    {% if settings.icon_fire_insulated %}
                                      <img
                                        src="{{ settings.icon_fire_insulated | img_url: '60x60' }}"
                                        alt="{{ settings.icon_fire_insulated_description | default: 'Fire Insulated' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {% else %}
                                      <div class="badge-placeholder" aria-label="Fire Insulated">FI</div>
                                    {% endif %}
                                  {% else %}
                                    {% assign fire_number = fire_resistance
                                      | remove: ' Minutes'
                                      | remove: 'Minutes'
                                      | remove: ' '
                                      | plus: 0
                                    %}
                                    {% if fire_number == 30 %}
                                      {% if settings.icon_fire_30_minutes %}
                                        <img
                                          src="{{ settings.icon_fire_30_minutes | img_url: '60x60' }}"
                                          alt="{{ settings.icon_fire_30_minutes_description | default: '30 Minutes Fire Resistance' }}"
                                          width="60"
                                          height="60"
                                          loading="lazy"
                                        >
                                      {% else %}
                                        <div class="badge-placeholder" aria-label="30 Minutes Fire Resistance">30</div>
                                      {% endif %}
                                    {% elsif fire_number == 60 %}
                                      {% if settings.icon_fire_60_minutes %}
                                        <img
                                          src="{{ settings.icon_fire_60_minutes | img_url: '60x60' }}"
                                          alt="{{ settings.icon_fire_60_minutes_description | default: '60 Minutes Fire Resistance' }}"
                                          width="60"
                                          height="60"
                                          loading="lazy"
                                        >
                                      {% else %}
                                        <div class="badge-placeholder" aria-label="60 Minutes Fire Resistance">60</div>
                                      {% endif %}
                                    {% elsif fire_number == 90 %}
                                      {% if settings.icon_fire_90_minutes %}
                                        <img
                                          src="{{ settings.icon_fire_90_minutes | img_url: '60x60' }}"
                                          alt="{{ settings.icon_fire_90_minutes_description | default: '90 Minutes Fire Resistance' }}"
                                          width="60"
                                          height="60"
                                          loading="lazy"
                                        >
                                      {% else %}
                                        <div class="badge-placeholder" aria-label="90 Minutes Fire Resistance">90</div>
                                      {% endif %}
                                    {% elsif fire_number == 120 %}
                                      {% if settings.icon_fire_120_minutes %}
                                        <img
                                          src="{{ settings.icon_fire_120_minutes | img_url: '60x60' }}"
                                          alt="{{ settings.icon_fire_120_minutes_description | default: '120 Minutes Fire Resistance' }}"
                                          width="60"
                                          height="60"
                                          loading="lazy"
                                        >
                                      {% else %}
                                        <div class="badge-placeholder" aria-label="120 Minutes Fire Resistance">120</div>
                                      {% endif %}
                                    {% else %}
                                      <div class="badge-placeholder" aria-label="{{ fire_resistance | escape }}">
                                        {{ fire_resistance | escape | truncate: 2, '' }}
                                      </div>
                                    {% endif %}
                                {% endcase %}
                              </div>
                              {% if fire_test_method != blank or fire_test_center != blank %}
                                <div class="badge-info-text">
                                  {% if fire_test_method != blank %}
                                    <div class="badge-info-line">{{ fire_test_method }}</div>
                                  {% endif %}
                                  {% if fire_test_center != blank %}
                                    <div class="badge-info-line">{{ fire_test_center }}</div>
                                  {% endif %}
                                </div>
                              {% endif %}
                              </div>
                            {% endif %}

                            {% if burglary_grade != blank
                              and burglary_grade != 'Ingen klassificering'
                              and burglary_grade != 'No classification'
                            %}
                              <div class="badge-with-info">
                              <div
                                class="target badge burglary-badge"
                                data-badge-type="burglary"
                                data-badge-value="{{ burglary_grade | escape }}"
                                title="Burglary Grade: {{ burglary_grade | escape }}"
                              >
                                {% case burglary_grade %}
                                  {% when 'S1' -%}
                                    {%- if settings.icon_burglary_s1 -%}
                                      <img
                                        src="{{ settings.icon_burglary_s1 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_s1_description | default: 'Security Grade S1' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Security Grade S1">S1</div>
                                    {% endif %}
                                  {% when 'S2', 'S2 (YELLOW Cabinet)' -%}
                                    {%- if settings.icon_burglary_s2 -%}
                                      <img
                                        src="{{ settings.icon_burglary_s2 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_s2_description | default: 'Security Grade S2' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Security Grade S2">S2</div>
                                    {% endif %}
                                  {% when 'GRADE 0' -%}
                                    {%- if settings.icon_burglary_grade_0 -%}
                                      <img
                                        src="{{ settings.icon_burglary_grade_0 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_grade_0_description | default: 'Burglary Grade 0' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Burglary Grade 0">G0</div>
                                    {% endif %}
                                  {% when 'GRADE I', 'GRADE I (RED Skafor)' -%}
                                    {%- if settings.icon_burglary_grade_1 -%}
                                      <img
                                        src="{{ settings.icon_burglary_grade_1 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_grade_1_description | default: 'Burglary Grade I' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Burglary Grade I">G1</div>
                                    {% endif %}
                                  {% when 'GRADE II' -%}
                                    {%- if settings.icon_burglary_grade_2 -%}
                                      <img
                                        src="{{ settings.icon_burglary_grade_2 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_grade_2_description | default: 'Burglary Grade II' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Burglary Grade II">G2</div>
                                    {% endif %}
                                  {% when 'GRADE III' -%}
                                    {%- if settings.icon_burglary_grade_3 -%}
                                      <img
                                        src="{{ settings.icon_burglary_grade_3 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_grade_3_description | default: 'Burglary Grade III' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Burglary Grade III">G3</div>
                                    {% endif %}
                                  {% when 'GRADE IV' -%}
                                    {%- if settings.icon_burglary_grade_4 -%}
                                      <img
                                        src="{{ settings.icon_burglary_grade_4 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_grade_4_description | default: 'Burglary Grade IV' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Burglary Grade IV">G4</div>
                                    {% endif %}
                                  {% when 'GRADE V' -%}
                                    {%- if settings.icon_burglary_grade_5 -%}
                                      <img
                                        src="{{ settings.icon_burglary_grade_5 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_grade_5_description | default: 'Burglary Grade V' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Burglary Grade V">G5</div>
                                    {% endif %}
                                  {% when 'GRADE VI' -%}
                                    {%- if settings.icon_burglary_grade_6 -%}
                                      <img
                                        src="{{ settings.icon_burglary_grade_6 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_grade_6_description | default: 'Burglary Grade VI' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Burglary Grade VI">G6</div>
                                    {% endif %}
                                  {% when 'GRADE VII' -%}
                                    {%- if settings.icon_burglary_grade_7 -%}
                                      <img
                                        src="{{ settings.icon_burglary_grade_7 | img_url: '60x60' }}"
                                        alt="{{ settings.icon_burglary_grade_7_description | default: 'Burglary Grade VII' }}"
                                        width="60"
                                        height="60"
                                        loading="lazy"
                                      >
                                    {%- else %}
                                      <div class="badge-placeholder" aria-label="Burglary Grade VII">G7</div>
                                    {% endif %}
                                  {% else %}
                                    <div class="badge-placeholder" aria-label="{{ burglary_grade | escape }}">
                                      {{ burglary_grade | escape | truncate: 3, '' }}
                                    </div>
                                {% endcase %}
                              </div>
                              {% if burglary_test_method != blank or burglary_test_center != blank %}
                                <div class="badge-info-text">
                                  {% if burglary_test_method != blank %}
                                    <div class="badge-info-line">{{ burglary_test_method }}</div>
                                  {% endif %}
                                  {% if burglary_test_center != blank %}
                                    <div class="badge-info-line">{{ burglary_test_center }}</div>
                                  {% endif %}
                                </div>
                              {% endif %}
                              </div>
                            {% endif %}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="collection-card-bottom">

                    {% if section.settings.show_button %}
                      <div class="collection-action target">
                        <a
                          href="{{ link_url }}"
                          class="collection-btn"
                          aria-label="View {{ col.title | escape }} {% if cheapest_product %}product{% else %}collection{% endif %}"
                        >
                          {% if cheapest_product %}
                            {{ section.settings.product_button_text | default: 'View Product' }}
                          {% else %}
                            {{ section.settings.button_text | default: 'View Collection' }}
                          {% endif %}
                        </a>
                      </div>
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          {% else %}
            <div class="empty-state">
              {{ section.settings.empty_text | default: 'No collections found' }}
            </div>
          {% endif %}
        {% endif %}
      </div>

      <div class="pagination" id="pagination-container"></div>

      {% if section.settings.show_products_section %}
        <div
          class="products-grid"
          id="products-grid"
          data-products-per-page="{{ section.settings.products_per_page | default: 16 }}"
          data-server-pagination="false"
        >
          {% assign rendered_seen_ids = ',' %}
          {% if is_valid_context and child_handles and child_handles.size > 0 %}
            {% for h in child_handles %}
              {% assign col = collections[h] %}
              {% if col %}
                {% for product in col.products %}
                  {% assign pid_token = ',' | append: product.id | append: ',' %}
                  {% unless rendered_seen_ids contains pid_token %}
                    {% assign rendered_seen_ids = rendered_seen_ids | append: product.id | append: ',' %}
                    {% unless product.title contains 'Gift Card' %}
                      {% render 'custom-product-card', product: product, collection_handle: col.handle %}
                    {% endunless %}
                  {% endunless %}
                {% endfor %}
              {% endif %}
            {% endfor %}
          {% endif %}
        </div>

        <div class="products-pagination" id="products-pagination-container"></div>
      {% endif %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Collection List",
  "tag": "section",
  "class": "collection-list-section",
  "settings": [
    { "type": "header", "content": "Section Settings" },
    { "type": "text", "id": "heading", "label": "Section Heading", "default": "Our Safe Collections" },
    {
      "type": "textarea",
      "id": "description",
      "label": "Section Description",
      "default": "Explore our comprehensive range of security solutions"
    },
    { "type": "url", "id": "show_more_link", "label": "Show More Link URL" },
    { "type": "text", "id": "show_more_text", "label": "Show More Button Text", "default": "Click here for more..." },

    { "type": "header", "content": "Collection Display Settings" },
    { "type": "checkbox", "id": "show_button", "label": "Show Collection Button", "default": true },
    { "type": "text", "id": "button_text", "label": "Collection Button Text", "default": "View Collection" },
    {
      "type": "text",
      "id": "product_button_text",
      "label": "Product Button Text",
      "default": "View Products",
      "info": "Text shown when redirecting to cheapest product instead of collection"
    },
    { "type": "text", "id": "price_label", "label": "Price Label", "default": "from" },
    { "type": "text", "id": "empty_text", "label": "No Results Text", "default": "No collections found" },

    { "type": "header", "content": "Products Section" },
    {
      "type": "checkbox",
      "id": "show_products_section",
      "label": "Show Products Section",
      "default": true,
      "info": "Display products from collections below collection cards"
    },
    {
      "type": "range",
      "id": "products_per_page",
      "min": 8,
      "max": 32,
      "step": 4,
      "label": "Products per page",
      "default": 16
    },
    {
      "type": "checkbox",
      "id": "show_collection_name_on_products",
      "label": "Show Collection Name on Products",
      "default": true
    },
    { "type": "checkbox", "id": "show_product_button", "label": "Show Product Button", "default": true },
    { "type": "text", "id": "products_button_text", "label": "Products Button Text", "default": "View Product" },

    { "type": "header", "content": "Related Products" },
    {
      "type": "checkbox",
      "id": "show_related_products",
      "label": "Show Related Products Section",
      "default": true,
      "info": "Show products that match selected filters below collections"
    },
    {
      "type": "text",
      "id": "related_products_title",
      "label": "Related Products Title",
      "default": "Matching Products"
    },
    {
      "type": "textarea",
      "id": "related_section_description",
      "label": "Related Products Description",
      "info": "Optional description text below the title"
    },
    {
      "type": "range",
      "id": "related_max_products",
      "min": 4,
      "max": 12,
      "step": 2,
      "label": "Maximum Products to Show",
      "default": 8
    },
    {
      "type": "range",
      "id": "related_max_collections",
      "min": 2,
      "max": 6,
      "step": 1,
      "label": "Maximum Collections to Search",
      "default": 4,
      "info": "How many visible collections to search for products"
    },
    {
      "type": "checkbox",
      "id": "related_show_collection_name",
      "label": "Show Collection Name",
      "default": true,
      "info": "Display the collection name above product title"
    },
    {
      "type": "checkbox",
      "id": "related_show_dimensions",
      "label": "Show Product Dimensions",
      "default": true,
      "info": "Display product dimensions if available"
    },
    {
      "type": "select",
      "id": "related_sort_order",
      "label": "Product Sort Order",
      "options": [
        { "value": "price_asc", "label": "Price: Low to High" },
        { "value": "price_desc", "label": "Price: High to Low" },
        { "value": "title_asc", "label": "Title: A-Z" },
        { "value": "relevance", "label": "Relevance" }
      ],
      "default": "price_asc"
    },
    {
      "type": "text",
      "id": "related_loading_text",
      "label": "Loading Text",
      "default": "Loading matching products..."
    },
    {
      "type": "text",
      "id": "related_empty_text",
      "label": "No Products Text",
      "default": "No products match your current filter selection."
    },
    { "type": "text", "id": "related_button_text", "label": "Product Button Text", "default": "View Product" },
    {
      "type": "select",
      "id": "related_grid_columns_desktop",
      "label": "Desktop Columns",
      "options": [
        { "value": "2", "label": "2 Columns" },
        { "value": "3", "label": "3 Columns" },
        { "value": "4", "label": "4 Columns" }
      ],
      "default": "4"
    },
    {
      "type": "select",
      "id": "related_grid_columns_mobile",
      "label": "Mobile Columns",
      "options": [
        { "value": "1", "label": "1 Column" },
        { "value": "2", "label": "2 Columns" }
      ],
      "default": "2"
    },

    { "type": "header", "content": "Filter Labels" },
    { "type": "text", "id": "filters_title", "label": "Filters Title", "default": "Filters" },
    {
      "type": "text",
      "id": "burglary_grade_label",
      "label": "Burglary Grade Filter Label",
      "default": "Burglary Grade"
    },
    {
      "type": "text",
      "id": "fire_resistance_label",
      "label": "Fire Resistance Filter Label",
      "default": "Fire Resistance"
    },
    { "type": "text", "id": "price_range_label", "label": "Price Range Filter Label", "default": "Price Range" },
    { "type": "text", "id": "depth_label", "label": "Depth Filter Label", "default": "Exterior Depth" },
    { "type": "text", "id": "width_label", "label": "Width Filter Label", "default": "Exterior Width" },
    { "type": "text", "id": "height_label", "label": "Height Filter Label", "default": "External Height" },
    { "type": "text", "id": "weight_label", "label": "Weight Filter Label", "default": "Weight" },

    { "type": "header", "content": "Mobile Filter Labels" },
    { "type": "text", "id": "mobile_filter_text", "label": "Mobile Filter Button Text", "default": "Filters" },
    { "type": "text", "id": "mobile_filter_title", "label": "Mobile Filter Title", "default": "Filters" },
    { "type": "text", "id": "mobile_apply_text", "label": "Mobile Apply Button Text", "default": "Apply Filters" },
    { "type": "text", "id": "mobile_clear_text", "label": "Mobile Clear Button Text", "default": "Clear All" },

    { "type": "header", "content": "Action Labels" },
    {
      "type": "text",
      "id": "clear_filters_text",
      "label": "Clear Filters Button Text",
      "default": "Clear All Filters"
    },
    {
      "type": "text",
      "id": "show_more_categories_text",
      "label": "Show More Categories Button Text",
      "default": "Show More Categories"
    },
    {
      "type": "text",
      "id": "show_less_categories_text",
      "label": "Show Less Categories Button Text",
      "default": "Show Less Categories"
    },
    { "type": "text", "id": "results_count_text", "label": "Results Count Text", "default": "Showing all collections" },

    { "type": "header", "content": "Display Labels" },
    { "type": "text", "id": "height_display_label", "label": "Height Display Label", "default": "Height" },
    { "type": "text", "id": "width_display_label", "label": "Width Display Label", "default": "Width" },
    { "type": "text", "id": "depth_display_label", "label": "Depth Display Label", "default": "Depth" },

    { "type": "header", "content": "Pagination Settings" },
    {
      "type": "range",
      "id": "collections_per_page",
      "min": 3,
      "max": 24,
      "step": 3,
      "label": "Collections per page",
      "default": 12
    },
    { "type": "checkbox", "id": "show_pagination", "label": "Show pagination", "default": true }
  ],
  "presets": [{ "name": "Collection List with Filters" }]
}
{% endschema %}
